<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="stylesheet" type="text/css" href="/public/styles.css" />
    
    
    
    
    
    <link rel="alternate" type="application/atom+xml" href="/feed.xml" title="Anil Dash RSS Feed">
    
    
    <title>Unfollowing Everybody - Anil Dash</title>

<meta name="description" content="A blog about making culture. Since 1999.">
<meta name="robots" content="index,follow">
<meta name="author" content="Anil Dash">

<link rel="canonical" href="https://www.anildash.com//2018/07/13/unfollowing_everybody/">

<meta property="og:title" content="Unfollowing Everybody - Anil Dash">
<meta property="og:type" content="article">

<meta property="og:url" content="https://www.anildash.com//2018/07/13/unfollowing_everybody/">
<meta property="og:description" content="A blog about making culture. Since 1999.">
<meta property="og:image" content="/images/anil-dash-unfollow.png">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://www.anildash.com//2018/07/13/unfollowing_everybody/">
<meta name="twitter:title" content="Unfollowing Everybody - Anil Dash">
<meta name="twitter:description" content="A blog about making culture. Since 1999.">
<meta name="twitter:image" content="/images/anil-dash-unfollow.png">


    
    
    <meta name="description" content="A blog about making culture. Since 1999.">
    <meta name="keywords" content="tech, writing, culture, systems, internet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#800080">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon.svg" sizes="any">
    <link rel="apple-touch-icon" href="/favicon.svg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Anil Dash">
    <link rel="apple-touch-icon" href="/images/icon-192.png">

    
    <meta name="color-scheme" content="light dark">
    
    
    <link rel="author" href="https://anildash.com/about">
    
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('SW registered: ', registration);
            })
            .catch(registrationError => {
              console.log('SW registration failed: ', registrationError);
            });
        });
      }
    </script>

    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://anildash.com/2018/07/13/unfollowing_everybody/"
      },
      "headline": "Unfollowing Everybody",
      "description": "A blog about making culture. Since 1999."
      ,
      "author": {
        "@type": "Person",
        "name": "Anil Dash",
        "url": "https://anildash.com/"
      },
      "publisher": {
        "@type": "Person",
        "name": "Anil Dash",
        "image": "https://cdn.glitch.global/d45aff89-36ba-46db-8c7c-3da7c8a93931/headshot-2022-square.jpeg?v=1698766406592"
      }
      ,
      "image": {
        "@type": "ImageObject",
        "url": "/images/anil-dash-unfollow.png"
      }
      
    }
    </script>
    
    
    
    
    
    <link rel="canonical" href="/2018/07/13/unfollowing_everybody/">
    
    
    
    
    <meta property="article:tag" content="posts, twitter">
    
    
    
    
        <link rel="apple-touch-icon" sizes="180x180" href="/images/anil-dash-unfollow.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/anil-dash-unfollow.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/anil-dash-unfollow.png">
        <link rel="icon" type= "image/x-icon" href="/images/anil-dash-unfollow.png">
    
    
    <meta name="generator" content="Eleventy v3.1.2">
    
    <meta name="twitter:creator" content="@anildash"/>
    
    <meta name="fediverse:creator" content="@anildash@me.dm" />
  </head>
  <body>
    <!-- Add skip link for keyboard navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="layout-wrapper">
      <header class="header" role="banner">
        <div class="header__content">
          <h1 class="site-title">
            <a href=/>
              Anil Dash
            </a>
          </h1>
          <!-- Add proper aria labeling -->
          <nav class="nav" aria-label="Main navigation">
            <ul class="nav__list">
              <li class="nav-item">
                <a rel="me" href="https://me.dm/@anildash" aria-label="Mastodon profile">mastodon</a>
              </li>
              <li class="nav-item">
                <a rel="me" href="https://bsky.app/profile/anildash.com" aria-label="Bluesky profile">bluesky</a>
              </li>
              <li class="nav-item">
                <a rel="me" href="https://www.threads.net/@anildash" aria-label="Threads profile">threads</a>
              </li>
              <li class="nav-item">
                <a href="https://anildash.com/about" >about</a>
              </li>
              <!-- Expandable Search -->
              <li class="nav-item">
                <div class="expandable-search" id="expandable-search">
                  <button 
                    class="search-toggle" 
                    id="search-toggle"
                    aria-label="Open search"
                    aria-expanded="false"
                    aria-controls="search-input-container"
                  >
                    <svg viewBox="0 0 24 24">
                      <circle cx="11" cy="11" r="8"></circle>
                      <path d="m21 21-4.35-4.35"></path>
                    </svg>
                  </button>
                  <div class="search-input-container" id="search-input-container" role="search">
                    <input 
                      type="search" 
                      placeholder="Search..."
                      aria-label="Search"
                      id="header-search-input"
                    >
                    <button 
                      class="search-close" 
                      id="search-close"
                      aria-label="Close search"
                    >√ó</button>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
        </div>
      </header>
      
      <!-- Compact Newsletter Signup Banner -->
      <div class="newsletter-banner" id="newsletter-banner">
        <div class="newsletter-content">
          <p class="newsletter-text">Get new posts by email (free, no spam)</p>
          <form 
            class="newsletter-form" 
            action="https://buttondown.email/api/emails/embed-subscribe/anildash"
            method="post"
            target="_blank"
          >
            <input 
              type="email" 
              name="email" 
              placeholder="your@email.com" 
              required 
              aria-label="Email for newsletter"
            >
            <input type="hidden" value="1" name="embed" />
            <button type="submit">Subscribe</button>
          </form>
          <button 
            class="newsletter-dismiss" 
            onclick="dismissNewsletter()" 
            aria-label="Dismiss newsletter signup"
            title="Dismiss"
          >√ó</button>
        </div>
      </div>
      
      
      <!-- Add breadcrumbs for SEO and navigation -->
      
      <nav aria-label="Breadcrumb" class="breadcrumbs">
        <ol vocab="https://schema.org/" typeof="BreadcrumbList">
          <li property="itemListElement" typeof="ListItem">
            <a property="item" typeof="WebPage" href="/">
              <span property="name">Home</span>
            </a>
            <meta property="position" content="1">
          </li>
          
          <li property="itemListElement" typeof="ListItem">
            <span property="name">Unfollowing Everybody</span>
            <meta property="position" content="2">
          </li>
          
        </ol>
      </nav>
      
      
      <!-- Add id for skip link target and role -->
      <main class="main" id="main-content" role="main">
        







<article class="post" data-pagefind-body data-pagefind-weight="1">
  
  <div style="display: none;">
    <span data-pagefind-meta="title">Unfollowing Everybody</span>
    <span data-pagefind-meta="date">13 Jul 2018</span>
    <span data-pagefind-meta="date_iso">2018-07-13</span>
    <span data-pagefind-sort="date">2018-07-13</span>
    
    <span data-pagefind-meta="heroimage">/images/anil-dash-unfollow.png</span>
    
    
    <span data-pagefind-meta="tags">twitter</span>
    
    <span data-pagefind-meta="excerpt">At this point, there's nothing novel about noticing that social media is often toxic and stressful. But even aside from those concerns, our social networks are...</span>
    
    
    
    
    <span data-pagefind-meta="search_weight">1</span>
  </div>
  
  <header class="post__header">

    <div class="post__details">
      <time datetime="2018-07-13">
        13 Jul 2018
      </time>
      <div class="post__tags">
      
        
        <a href="/tags/twitter/">twitter</a>
        
        <div data-pagefind-filter="tag" style="display: none;">twitter</div>
      
      </div>
      <button id="share-link" aria-label="share"></button>
    </div>
    
    
    
    
    
    
    
    <figure class="heroimage" style="background-image: url(/images/anil-dash-unfollow.png);">
      
    </figure>
    
    
    
    <h1 data-pagefind-weight="1.5">Unfollowing Everybody</h1>

  </header>

  
  <main class="post__content" data-pagefind-weight="1">
    <p>At this point, there's nothing novel about noticing that social media is often toxic and stressful. But even aside from those concerns, our social networks are not things we generally think of as requiring maintenance or upkeep, even though we routinely do regular updates on all the other aspects of our digital lives.</p>
<p>Keeping in mind that spirit of doing necessary maintenance, I recently did something I'd thought about doing for years: I unfollowed everyone on Twitter. Now, these kinds of decisions are oddly fraught; a lot of people see their following relationships on social media as a form of status, not merely an indication of where information is flowing between people. But I decided to assume that the people I'm connected to know that me unfollowing everyone isn't personal, but really just a response to the overwhelming noise of having more than 5000 accounts sharing info with me on a single network.</p>
<p><strong>Update:</strong> Julius Tarng made an enormously popular, and really charming, Glitch app called <a href="https://tokimeki-unfollow.glitch.me/">Tokimeki Unfollow</a> that helps you clean up your timeline, and makes it easy to unfollow any accounts that don't bring you joy. Definitely use this if you don't want to do a bunch of tech stuff!</p>
<div class="glitch-embed-wrap" style="height: 420px; width: 100%;">
  <iframe
    src="https://glitch.com/embed/#!/embed/tokimeki-unfollow?path=README.md&previewSize=100"
    title="tokimeki-unfollow on Glitch"
    allow="geolocation; microphone; camera; midi; vr; encrypted-media"
    style="height: 100%; width: 100%; border: 0;">
  </iframe>
</div>
<hr>
<h2>How I did it</h2>
<p>Okay, this part is gonna get slightly geeky, if you're not a coder, but I thought I'd explain the process in case anyone wants to repeat it.</p>
<p>Years ago, Twitter used to have a command-line interface for performing bulk or automated actions on an account. They abandoned it after a while, so Erik Berlin created a new command-line tool for power users of Twitter, <a href="https://github.com/sferik/t">simply called &quot;t&quot;</a>. It's written in Ruby (a language I basically can read but not really write) so it's easy enough to get running if you follow the <a href="https://github.com/sferik/t#dependencies">few simple setup steps</a>.</p>
<p>As Erik mentions in that documentation, you'll then need to set up a <a href="https://apps.twitter.com/">new Twitter app</a> on your account, and get the credentials that will let the <code>t</code> tool perform actions on your Twitter account. (Note: I got some errors while updating and authenticating; making <a href="https://github.com/sferik/twitter/issues/878#issuecomment-349718252">these edits</a> to one of the ruby libraries that <code>t</code> depends on fixed the issue immediately.)</p>
<h2>The Plan</h2>
<p>At that point, I wanted to follow a few simple steps. These took a little longer for me because I was following over 5,000 people on Twitter, but if you're following a more reasonable number, none of these steps should take more than a few minutes to complete. This was my plan:</p>
<ol>
<li>Copy all the people I was following to a <a href="https://help.twitter.com/en/using-twitter/twitter-lists">Twitter list</a>, so I could still access them in my Twitter apps on all my devices, and I could still see my old timeline at any point if I wanted to.</li>
<li>Archive all of the people I was following into a spreadsheet, so I could sort through them and filter for geography or how many followers they have or whether they were verified or not ‚Äî basically any criteria that might be interesting when deciding who to follow (or <em>not</em> follow).</li>
<li>Actually unfollow everybody and start over.</li>
</ol>
<p>As it turns out, each of these steps is pretty easy.</p>
<h3>Copying all your follows to a List</h3>
<p>If you want to back up all of your followers, you only need to make a list and then populate it. You can make lists in most regular Twitter apps, but to do it at the command line it's simple: type in <code>t list create following-`date &quot;+%Y-%m-%d&quot;`</code> to make a list named after the current date, so you can easily remember this was a list of who you were following as of today. You can pretty easily understand the <code>t</code> syntax here ‚Äî commands like <code>list create</code> are pretty self-explanatory.</p>
<p>Next, we have a slightly more elaborate command to copy all of your followers to the new list; you'll dump out a list of everyone you follow, and then pipe that into another <code>t</code> command to add them to your new list. It works like so: <code>t followings | xargs t list add following-`date &quot;+%Y-%m-%d&quot;`</code>. (If you're like me, you'll be doing all this stuff around midnight, and the date will change in the middle of it, and you should just type in the current date instead of using <code>date</code> variables.)</p>
<p>That's it! Now you've got a list of all your followers, and if you browse that list in your Twitter client app, you should see the exact same thing as your regular timeline. Do note, though, that Twitter lists don't function well with more than a few thousand followers. It took hours for all 5,000+ of my followers to show up on the list, and in the interim the counts of how many people belonged to the list were often incorrect.</p>
<h3>Archiving your follows into a spreadsheet</h3>
<p>This one is just a fun thing to do in general, if you like to slice and dice data about your social network. <code>t</code> supports exporting a pretty broad set of data about your followers, not just their names and Twitter handles, by allowing for a &quot;long format&quot; export with complete data. You get stuff like how many favorites (likes) they have on Twitter, when their account was created, and how many people they follow or are followed by. Frustratingly, Twitter no longer makes it easy for this data export to include whether that person follows <em>you</em> or not; that requires an additional query.</p>
<p>You'll use CSV (comma-separated values) as the format for exporting your data into a spreadsheet. And good news! <code>t</code> supports that natively. So your command will look like this: <code>t followings -l --csv &gt; followings.csv</code> which basically says &quot;Export my followings, in long format, to a CSV file named 'followings.csv'.&quot; Once you do that, you can open it up in Excel or Google Sheets in a few clicks, and you're all set.</p>
<p><img src="https://cdn.glitch.global/c4e475b2-a54e-47e0-973c-ed0bd1b46262/followings-spreadsheet.png?v=1669624499116" alt="spreadsheet of people I used to follow on Twitter" title="spreadsheet of people I used to follow on Twitter"></p>
<p>After all the people I followed were in a spreadsheet, I was able to sort by how many followers or followings they had, and also their last update, and I found friends who'd passed away whose accounts had been dormant for years, or joke accounts whose relevance had expired, or quiet voices with small networks that had been drowned out amongst the cacophany of the many other voices I was hearing each day. I found this part to be a really worthwhile exercise, and definitely decided to follow fewer people with huge networks and lots of reach.</p>
<h3>Actually unfollowing!</h3>
<p>Then, it was time for the main event: actually unfollowing everybody. I don't think this will be as much of a problem for other folks, but trying to run a single process of unfollowing everybody had me repeatedly running into Twitter's rate limits, where they try to keep any app from performing too many actions on your account in too short a period of time. I ended up writing a simple script to do the unfollowing in batches, then pausing for a few minutes, then starting up again.</p>
<p>But with a more reasonable network, the command to unfollow everyone is extremely simple:</p>
<p><code>t followings | xargs t unfollow</code></p>
<p>It'll chug away for a few minutes, and then that's it! You're not following anybody anymore. Except it might still <em>look</em> like you are.</p>
<blockquote class="twitter-tweet" data-dnt="true" data-theme="dark"><p lang="en" dir="ltr">A number of people are noticing that my follower count says something other than 5, or that you see incorrect lists of who I follow. This is an artifact of a design called ‚Äúeventual consistency‚Äù, which Twitter &amp; other distributed systems use to help scale. <a href="https://t.co/FGzQ9qR0SG">https://t.co/FGzQ9qR0SG</a></p>&mdash; anildash (@anildash) <a href="https://twitter.com/anildash/status/1014695768903413760?ref_src=twsrc%5Etfw">July 5, 2018</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>In my case, my follower count was wrong for <em>days</em>, and kept showing wildly inaccurate information like insisting that I was following one of Mike Pence's official accounts. (Needless to say, that was never the case.) All of this is due to a architectural decision called <a href="https://en.wikipedia.org/wiki/Eventual_consistency">eventual consistency</a>, which helps enable Twitter to scale to its massive size, but doesn't do as good a job of handling unusual circumstances like being able to immediately see the correct list of followers for someone who has just unfollowed thousands of accounts.</p>
<p>Nevertheless, the deed was done. I refollowed a few essential accounts (my family, <a href="https://twitter.com/glitch">@Glitch</a> and <a href="https://twitter.com/prince">@Prince</a>, and was ready to start anew.</p>
<h2>Lessons learned</h2>
<p>It's been about a week and a half, and, well... Twitter is a lot more pleasant. I've chosen a handful of accounts to follow each day (most ones that I followed before, some entirely new to me) and it's made a big difference. On the flip side, about 100 people seem to have unfollowed me after I unfollowed everybody, and I hope they hadn't felt obligated just to reciprocate if I was following them before. (That might also just be how many people unfollow me in a given week, I dunno.)</p>
<p>One of the most immediate benefits is that, when something terrible happens in the news, I don't see an endless, repetitive stream of dozens of people reacting to it in succession. It turns out, I don't mind knowing about current events, but it <em>hurts</em> to see lots of people I care about going through anguish or pain when bad news happens. I want to optimize for being aware, but not emotionally overwhelmed.</p>
<p>To that point, I've also basically not refollowed <em>any</em> news accounts or &quot;official&quot; corporate accounts. Anything I need to know about major headlines gets surfaced through other channels, or even just other parts of Twitter, so I don't need to see social media updates from media companies whose entire economic model is predicated on causing me enough stress to click through to their sites.</p>
<p>Similarly, I've focused a <em>lot</em> more on artists and activists and people who write about the stuff I'm obsessed with in general ‚Äî Prince or mangoes or urban transit or the like. That brings a lot more joy into my life, and people writing about these other topics offer alot more inspiration for the things I want to be focused on. Oddly, given that my job is being the CEO of a tech company, I follow <em>far</em> fewer people in tech, and almost no tech company accounts except for my own. Despite that, I've missed almost nothing significant in the industry since making this change.</p>
<h2>The algorithm is learning</h2>
<p>Most interesting to me is how the suggested content and accounts on Twitter have changed since I changed my network. Before, much of the suggested headlines or featured Tweets in my Twitter apps would be from categories like &quot;Technology VC&quot;; now they're much more likely to be about &quot;Climate Change&quot; or &quot;Comedians&quot; than about inside-baseball tech talk.</p>
<p>On the less positive side, Twitter <em>still</em> suggests that I follow accounts that are almost entirely men, and overwhelmingly white American men with verified Twitter accounts. This is bizarre to me as I'm <a href="https://twitter.com/following">now following nearly 100 accounts</a>, and they're basically the same mix of races and genders and geographies that I've always been interested in hearing from. I would have expected Twitter's follow-suggestion algorithm to be at least as adaptive as its content-suggestion one, and hope that it'll get updated to feature accounts that don't fit the usual privileged patterns. (I do still follow a lot of verified accounts, but some of that is due to an oddity I've just realized, which is that a lot of my friends have verified accounts. Look, ma ‚Äî I'm a big-city elite!)</p>
<h3>What Follows</h3>
<p>I don't have some grand takeaway about what all this means; obviously, I've been thinking about the design and impacts and best use of social networks on the web for basically as long as they've existed. I strongly believe we should be intentional in how we use our networks, and even spent years building tools to encourage that, though the corporate interest of the major social networks precludes building a business around encouraging healthier use of their platforms.</p>
<p>But I'm happy for making a conscious decision about managing my network, and I lament that it takes a pretty extreme level of technical knowledge to be able to do so. I first <a href="/2007/02/14/consider_twitte/">wrote about Twitter</a> when it was only a few months old, talking about its promise and predicting that Twitter would adopt @messaging and adapt to other ways its community was inventing new behaviors. Some of that happened, but of course most of what power users (and vulnerable users) wanted was never created.</p>
<p>I've also written a good bit about the peculiarities of having a large network in social media, like <a href="/2009/12/29/life_on_the_list/">Twitter's early practice of suggesting which accounts to follow</a> (including mine!) and what it's like to <a href="https://medium.com/message/nobody-famous-37790cb4d014">have the social network of a famous person</a> without actually being famous. I think a lot about <a href="/2011/06/09/all_in_favor/">why I &quot;favorite&quot; (or like) so many things</a> on various networks. And I also hope people can think more broadly about the ways the design of social networks intersects with how we see ourselves, and how we see social status, as best exemplified by the huge social anxieties around <a href="/2013/03/01/what_its_like_being_verified_on_twitter/">what it's like being verified on Twitter</a>.</p>
<p>And ultimately, I come back to what I <a href="https://medium.com/the-only-woman-in-the-room/the-year-i-didnt-retweet-men-79403a7eade1">wrote a few years ago</a> when I first decided to stop retweeting men (a practice I've followed for about half a decade now):</p>
<blockquote>
<p>If you‚Äôre inclined, try being mindful of whose voices you share, amplify, validate and promote to others.</p>
</blockquote>
<p>It's still a really important point, and to this list I would only add: Also be mindful about who you follow. And don't be afraid sometimes to reset and start over.</p>

  </main>

  <aside class="post__aside">

    <nav class="post__pagination">

        <a href="/2018/05/11/the_cartoon_kit/">
          <span>‚Üê</span>
          <span>The Cartoon Kit</span>
        </a>

      

        <a href="/2018/08/03/a_much_faster_way_to_charge_your_iphone_x/">
          <span>A Much Faster Way to Charge your iPhone</span>
          <span>‚Üí</span>
        </a>

      
      
    </nav>
  </aside>

</article>

  <script>
    const shareData = {
      title: 'Unfollowing Everybody',
      url: 'https://anildash.com/2018/07/13/unfollowing_everybody/'
    }

    const btn = document.querySelector('#share-link');

    // Share must be triggered by "user activation"
    btn.addEventListener('click', async () => {
      try {
        await navigator.share(shareData);
      } catch (err) {
      }
    });  
  </script>
  
      </main>
      <footer class="footer" role="contentinfo">
        <div class="footer__content">
          <!-- Add proper aria labeling -->
          <nav aria-label="Footer navigation">
            <ul class="hero__social-links">
                <li>
                  <a href="/search/" >Search</a>
                </li>
                <li>
                  <a href="/posts/" >All Posts</a>
                </li>
                <!-- Theme toggle button -->
                <li class="theme-toggle-container">
                  <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <span class="theme-toggle-light" aria-hidden="true">‚òÄÔ∏è</span>
                    <span class="theme-toggle-dark" aria-hidden="true">üåô</span>
                  </button>
                </li>
                <li>
                  <a href="/feed.xml" target="_blank" rel="noopener noreferrer" aria-label="RSS Feed">
                    <img src="/images/rss.svg" alt="RSS Feed" width="16" height="16" id="rss-icon" />
                  </a>
                </li>
            </ul>
          </nav>
          
          <!-- Add copyright info -->
          <div class="copyright">
            <p>&copy; 1999‚Äì2025 Anil Dash. Virtually no rights reserved. Just ask nicely.</p>
          </div>
        </div>
      </footer>
    </div>
    
    
    
    
    <!-- Add dark mode toggle script -->
    <script>
      // Theme toggle functionality
      document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        
        // Function to set theme
        const setTheme = (theme) => {
          html.setAttribute('data-theme', theme);
          localStorage.setItem('theme', theme);
        };
        
        // Check for saved theme preference or use system preference
        const savedTheme = localStorage.getItem('theme');
        
        if (savedTheme) {
          // Use saved preference if available
          setTheme(savedTheme);
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          // Use system preference if no saved preference
          setTheme('dark');
        } else {
          // Default to light mode
          setTheme('light');
        }
        
        // Toggle theme when button is clicked
        themeToggle.addEventListener('click', () => {
          const currentTheme = html.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          setTheme(newTheme);
        });
        
        // Listen for system preference changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
          if (!localStorage.getItem('theme')) {
            // Only update if user hasn't set a preference
            setTheme(e.matches ? 'dark' : 'light');
          }
        });
      });
      
      
      

      // Handle focus management for keyboard users
      document.addEventListener('DOMContentLoaded', function() {
        const skipLink = document.querySelector('.skip-link');
        if (skipLink) {
          skipLink.addEventListener('focus', function() {
            this.style.transform = 'translateY(0)';
          });
          skipLink.addEventListener('blur', function() {
            this.style.transform = 'translateY(-100%)';
          });
        }
      });

      // search functionality
      document.addEventListener('DOMContentLoaded', function() {
        const expandableSearch = document.getElementById('expandable-search');
        const searchToggle = document.getElementById('search-toggle');
        const searchClose = document.getElementById('search-close');
        const searchInput = document.getElementById('header-search-input');
        
        if (!expandableSearch || !searchToggle || !searchInput) return;
        
        function openSearch() {
          expandableSearch.classList.add('expanded');
          searchToggle.setAttribute('aria-expanded', 'true');
          searchToggle.setAttribute('aria-label', 'Close search');
          // Focus the input after animation completes
          setTimeout(() => searchInput.focus(), 300);
        }
        
        function closeSearch() {
          expandableSearch.classList.remove('expanded');
          searchToggle.setAttribute('aria-expanded', 'false');
          searchToggle.setAttribute('aria-label', 'Open search');
          searchInput.value = '';
        }
        
        // Toggle search on button click
        searchToggle.addEventListener('click', function() {
          if (expandableSearch.classList.contains('expanded')) {
            closeSearch();
          } else {
            openSearch();
          }
        });
        
        // Close search when close button is clicked
        if (searchClose) {
          searchClose.addEventListener('click', closeSearch);
        }
        
        // Close search on Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && expandableSearch.classList.contains('expanded')) {
            closeSearch();
            searchToggle.focus(); // Return focus to toggle button
          }
        });
        
        // Handle search submission
        searchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && this.value.trim()) {
            e.preventDefault();
            // Redirect to search page with query
            const searchQuery = encodeURIComponent(this.value.trim());
            window.location.href = `/search/?q=${searchQuery}`;
          }
        });
        
        // Close search when clicking outside
        document.addEventListener('click', function(e) {
          if (!expandableSearch.contains(e.target) && expandableSearch.classList.contains('expanded')) {
            closeSearch();
          }
        });
        
        // Prevent search container clicks from closing
        searchInput.parentElement.addEventListener('click', function(e) {
          e.stopPropagation();
        });
      });

    </script>
  </body>
</html>