<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="stylesheet" type="text/css" href="/public/styles.css" />
    
    
    
    
    
    <link rel="alternate" type="application/atom+xml" href="/feed.xml" title="Anil Dash RSS Feed">
    
    
    <title>Underscores, Optimization &amp; Arms Races - Anil Dash</title>

<meta name="description" content="A blog about making culture. Since 1999.">
<meta name="robots" content="index,follow">
<meta name="author" content="Anil Dash">

<link rel="canonical" href="https://www.anildash.com//2017/11/29/underscores_optimization_arms_races/">

<meta property="og:title" content="Underscores, Optimization &amp; Arms Races - Anil Dash">
<meta property="og:type" content="article">

<meta property="og:url" content="https://www.anildash.com//2017/11/29/underscores_optimization_arms_races/">
<meta property="og:description" content="A blog about making culture. Since 1999.">
<meta property="og:image" content="/images/type-curve-1.jpeg">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://www.anildash.com//2017/11/29/underscores_optimization_arms_races/">
<meta name="twitter:title" content="Underscores, Optimization &amp; Arms Races - Anil Dash">
<meta name="twitter:description" content="A blog about making culture. Since 1999.">
<meta name="twitter:image" content="/images/type-curve-1.jpeg">


    
    
    <meta name="description" content="A blog about making culture. Since 1999.">
    <meta name="keywords" content="tech, writing, culture, systems, internet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#800080">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon.svg" sizes="any">
    <link rel="apple-touch-icon" href="/favicon.svg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Anil Dash">
    <link rel="apple-touch-icon" href="/images/icon-192.png">

    
    <meta name="color-scheme" content="light dark">
    
    
    <link rel="author" href="https://anildash.com/about">
    
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('SW registered: ', registration);
            })
            .catch(registrationError => {
              console.log('SW registration failed: ', registrationError);
            });
        });
      }
    </script>

    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://anildash.com/2017/11/29/underscores_optimization_arms_races/"
      },
      "headline": "Underscores, Optimization & Arms Races",
      "description": "A blog about making culture. Since 1999."
      ,
      "author": {
        "@type": "Person",
        "name": "Anil Dash",
        "url": "https://anildash.com/"
      },
      "publisher": {
        "@type": "Person",
        "name": "Anil Dash",
        "image": "https://cdn.glitch.global/d45aff89-36ba-46db-8c7c-3da7c8a93931/headshot-2022-square.jpeg?v=1698766406592"
      }
      ,
      "image": {
        "@type": "ImageObject",
        "url": "/images/type-curve-1.jpeg"
      }
      
    }
    </script>
    
    
    
    
    
    <link rel="canonical" href="/2017/11/29/underscores_optimization_arms_races/">
    
    
    
    
    <meta property="article:tag" content="posts, web, google, search, tech">
    
    
    
    
        <link rel="apple-touch-icon" sizes="180x180" href="/images/type-curve-1.jpeg">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/type-curve-1.jpeg">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/type-curve-1.jpeg">
        <link rel="icon" type= "image/x-icon" href="/images/type-curve-1.jpeg">
    
    
    <meta name="generator" content="Eleventy v3.1.2">
    
    <meta name="twitter:creator" content="@anildash"/>
    
    <meta name="fediverse:creator" content="@anildash@me.dm" />
  </head>
  <body>
    <!-- Add skip link for keyboard navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="layout-wrapper">
      <header class="header" role="banner">
        <div class="header__content">
          <h1 class="site-title">
            <a href=/>
              Anil Dash
            </a>
          </h1>
          <!-- Add proper aria labeling -->
          <nav class="nav" aria-label="Main navigation">
            <ul class="nav__list">
              <li class="nav-item">
                <a rel="me" href="https://me.dm/@anildash" aria-label="Mastodon profile">mastodon</a>
              </li>
              <li class="nav-item">
                <a rel="me" href="https://bsky.app/profile/anildash.com" aria-label="Bluesky profile">bluesky</a>
              </li>
              <li class="nav-item">
                <a rel="me" href="https://www.threads.net/@anildash" aria-label="Threads profile">threads</a>
              </li>
              <li class="nav-item">
                <a href="https://anildash.com/about" >about</a>
              </li>
              <!-- Expandable Search -->
              <li class="nav-item">
                <div class="expandable-search" id="expandable-search">
                  <button 
                    class="search-toggle" 
                    id="search-toggle"
                    aria-label="Open search"
                    aria-expanded="false"
                    aria-controls="search-input-container"
                  >
                    <svg viewBox="0 0 24 24">
                      <circle cx="11" cy="11" r="8"></circle>
                      <path d="m21 21-4.35-4.35"></path>
                    </svg>
                  </button>
                  <div class="search-input-container" id="search-input-container" role="search">
                    <input 
                      type="search" 
                      placeholder="Search..."
                      aria-label="Search"
                      id="header-search-input"
                    >
                    <button 
                      class="search-close" 
                      id="search-close"
                      aria-label="Close search"
                    >√ó</button>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
        </div>
      </header>
      
      <!-- Compact Newsletter Signup Banner -->
      <div class="newsletter-banner" id="newsletter-banner">
        <div class="newsletter-content">
          <p class="newsletter-text">Get new posts by email (free, no spam)</p>
          <form 
            class="newsletter-form" 
            action="https://buttondown.email/api/emails/embed-subscribe/anildash"
            method="post"
            target="_blank"
          >
            <input 
              type="email" 
              name="email" 
              placeholder="your@email.com" 
              required 
              aria-label="Email for newsletter"
            >
            <input type="hidden" value="1" name="embed" />
            <button type="submit">Subscribe</button>
          </form>
          <button 
            class="newsletter-dismiss" 
            onclick="dismissNewsletter()" 
            aria-label="Dismiss newsletter signup"
            title="Dismiss"
          >√ó</button>
        </div>
      </div>
      
      
      <!-- Add breadcrumbs for SEO and navigation -->
      
      <nav aria-label="Breadcrumb" class="breadcrumbs">
        <ol vocab="https://schema.org/" typeof="BreadcrumbList">
          <li property="itemListElement" typeof="ListItem">
            <a property="item" typeof="WebPage" href="/">
              <span property="name">Home</span>
            </a>
            <meta property="position" content="1">
          </li>
          
          <li property="itemListElement" typeof="ListItem">
            <span property="name">Underscores, Optimization &amp; Arms Races</span>
            <meta property="position" content="2">
          </li>
          
        </ol>
      </nav>
      
      
      <!-- Add id for skip link target and role -->
      <main class="main" id="main-content" role="main">
        







<article class="post" data-pagefind-body data-pagefind-weight="1">
  
  <div style="display: none;">
    <span data-pagefind-meta="title">Underscores, Optimization &amp; Arms Races</span>
    <span data-pagefind-meta="date">29 Nov 2017</span>
    <span data-pagefind-meta="date_iso">2017-11-29</span>
    <span data-pagefind-sort="date">2017-11-29</span>
    
    <span data-pagefind-meta="heroimage">/images/type-curve-1.jpeg</span>
    
    
    <span data-pagefind-meta="tags">web, google, search, tech</span>
    
    <span data-pagefind-meta="excerpt">A dozen years ago, the web started to reshape itself around major companies like Google. We can understand the genesis of today‚Äôs algorithmic arms race against...</span>
    
    
    
    
    <span data-pagefind-meta="search_weight">1</span>
  </div>
  
  <header class="post__header">

    <div class="post__details">
      <time datetime="2017-11-29">
        29 Nov 2017
      </time>
      <div class="post__tags">
      
        
        <a href="/tags/web/">web</a>
        
        <div data-pagefind-filter="tag" style="display: none;">web</div>
      
        
        <a href="/tags/google/">google</a>
        
        <div data-pagefind-filter="tag" style="display: none;">google</div>
      
        
        <a href="/tags/search/">search</a>
        
        <div data-pagefind-filter="tag" style="display: none;">search</div>
      
        
        <a href="/tags/tech/">tech</a>
        
        <div data-pagefind-filter="tag" style="display: none;">tech</div>
      
      </div>
      <button id="share-link" aria-label="share"></button>
    </div>
    
    
    
    
    
    
    
    <figure class="heroimage" style="background-image: url(/images/type-curve-1.jpeg);">
      
    </figure>
    
    
    
    <h1 data-pagefind-weight="1.5">Underscores, Optimization &amp; Arms Races</h1>

  </header>

  
  <main class="post__content" data-pagefind-weight="1">
    <p>A dozen years ago, the web started to reshape itself around major companies like Google. We can understand the genesis of today‚Äôs algorithmic arms race against the tech titans just by looking at a single character.
<img src="/images/typewriter-keys.jpeg" alt="">
This is all ancient tech history now, but content management systems used to be one of those competitive markets that tech people watched avidly. (CMSes are the tools people use to publish stuff on the Internet‚Ää‚Äî‚ÄäMedium, where I originally wrote this, is one, and some of the big ones people use today are WordPress or Drupal.)</p>
<p>Back in the early 2000s, I helped create two then-popular CMS tools, Movable Type and TypePad; pretty soon, WordPress and Drupal and other tools came onto the scene solving a similar set of problems. All of these apps basically did the same thing they do today: You type in a box, and hit publish, and it makes a nice-looking web page with whatever you wrote. At first they were used by individual bloggers to keep personal sites, but they quickly took over publishing for almost every media outlet on the web. It was a booming market, and the people working on these tools were some of the first wave of high-profile social media startup founders.</p>
<p>Friendster was around then, and MySpace was growing in prominence. (Facebook didn‚Äôt come around until a little later, and was still just for Ivy League kids for a long time.) But the biggest player on the rise in that era was Google. They‚Äôd bought Blogger, one of the earliest popular social media tools, in early 2003 and then launched their AdSense advertising platform a few months later. All of a sudden, Google was massively influencing content and monetization in the new world of social media.</p>
<p><img src="/images/type-keys.jpeg" alt=""></p>
<h2>Drawing a line</h2>
<p>Just as we see Instagram and Snapchat going back and forth today one-upping each other‚Äôs features, in the early 2000s, people were constantly making new features for publishing in the then-new format of blogging. Todays social apps might distinguish themselves based on who has the best photo filters, but the technological distinctions between content management systems were a lot nerdier, like really esoteric and detailed technical controls over the design of your website.</p>
<p>The early era of the social web was a time of incredible advancement in web design. There was a revolution in aesthetics, focused around simplicity and white space and advances in typography and styling, and this was matched by huge leaps in accessibility and conformance with the open technical standards that defined the web itself. Basically, the web got a lot more pleasant really quickly, driven in large part by the influence of the people who were creating the early social media platforms. Things got good enough that it was worth the time to sweat little things like the formatting of web addresses.</p>
<p>Yep‚Äîwe got so picky about design that one of the elements of a website that people wanted to control was the web address (URL) of the webpages themselves. At first, each of the posts on your blog would live at an address that was something like <code>example.com/00000002.html</code>, with the number going up each time you wrote a new post. But that long, nerdy-looking number offended a lot of people‚Äôs aesthetic sensibilities, so pretty soon addresses started to look like <code>example.com/2004/04/story.html</code> and that was a little better.</p>
<p>Eventually, people wanted to have the whole title of their article show up in the web address. Part of this was just because it looked cool, but some folks had started to suspect that having those words in the address might help a blog post rank higher on Google. (Google was still a smaller player in the overall web search market at the time, but it was already by far the most popular search engine amongst internet geeks.)</p>
<p>But here‚Äôs the thing: web addresses can‚Äôt have spaces in them. To include a full title with spaces in a web address for a blog, the spaces would either have to be removed (ugly!) or converted into something equivalent. Since we were one of the first to encounter this issue, our team designed to have our content management system use underscores, based on the rationale that underscores were the character that most closely resembled a blank space.</p>
<p>The end result? Anybody who used our tools could write a a blog post entitled ‚ÄúMy Great Cookie Recipe‚Äù and it would live at an address that looked like <code>example.com/2005/04/my_great_cookie_recipe.html</code>. By contrast, the WordPress team thought that hyphens looked better, so blog posts published on their tool would look more like <code>example.com/2005/04/my-great-cookie-recipe</code>. Sure, these different tools made slightly different choices about which character to use, but such a subtle distinction couldn‚Äôt be meaningful, right?</p>
<p>As it would turn out, we‚Äôd stumbled across a harbinger of how the entire web was about to change.</p>
<p><img src="/images/type-closeup.jpeg" alt=""></p>
<h2>The rise of SEO</h2>
<p>Just as the social media era of the web was taking off, Google‚Äôs rapidly-growing platform radically changed the nature of content and sharing on the web. Anybody with a website was starting to understand that ranking highly on Google was immensely valuable, and as Google‚Äôs ad platform boomed, seeing those paid results alongside ‚Äúorganic‚Äù search results made it even clearer that a high ranking had monetary value.</p>
<p>Initially, information of how to rank better on Google was exchanged almost as folk knowledge‚Äîhalf urban legends or myth, half insights that were gleaned through painful experience but not documented anywhere. Soon, the dark arts of earning Google‚Äôs favor came to be known as ‚Äúsearch engine optimization‚Äù, and what began as informal sharing of guesses about Google‚Äôs function started to grow into what became a multi-billion-dollar industry.</p>
<h2>Everybody Loves Dashes</h2>
<p>Even as SEO matured and formalized, Google had very little documentation and no designated ombudsman to handle questions about how to be in their search engine‚Äôs good graces. Eventually, early Googler <a href="https://www.mattcutts.com/blog/">Matt Cutts</a> took up the mantle of representing the company to the community as advocate for best practices in search optimization, using his personal blog to explain company policies that had heretofore been opaque or inscrutable. There was a feel of Kremlinology to the way his minor public utterances would be parsed for any hints that outsiders could glean about Google‚Äôs inner workings. But just as often, Cutts would make clear pronouncements of What To Do, and these were received by the SEO community almost as religious edicts.</p>
<p>One such declaration in the summer of 2005 came like a lightning bolt, a proclamation on <a href="https://www.mattcutts.com/blog/dashes-vs-underscores/">Dashes vs. underscores</a>:</p>
<blockquote>
<p>I often get asked whether I‚Äôd recommend dashes or underscores for words in urls. For urls in Google, I would recommend using dashes.</p>
</blockquote>
<p>There was a lot of nuance in Matt‚Äôs post, but pretty soon the perception for a lot of SEO people became ‚Äú<strong>dashes good, underscores bad</strong>‚Äù. (The punctuation in URLs are hyphens, technically known as Hyphen-minus, but sure, let‚Äôs call them dashes.) To most people in the industry, this settled things. Google had told us all what they preferred, and everybody wanted to rank highly in Google, so SEO experts fell in line. Everything was to be dashes, forevermore.</p>
<p>But once you‚Äôve trained a community that they constantly need to guess at the secret machinations of your algorithm, they‚Äôre not going to stop doing so just because you‚Äôve made a public pronouncement.</p>
<p>For years, despite Cutts‚Äô clear statement, the choice of punctuation remained such a point of contention and debate that <a href="http://www.ecreativeim.com/blog/2011/03/seo-basics-hyphen-or-underscore-for-seo-urls/">countless</a><a href="https://www.seomechanic.com/seo-101-hyphens-underscores-_-urls/">stories</a> were <a href="https://searchengineland.com/9-seo-quirks-you-should-be-aware-of-146465">written</a> about how best to appease the fickle Googlebot. Eventually, discussion around hyphens and underscores in web addresses became so fraught and so persistent that <em>six years after</em> that initial blog post, Cutts made <a href="https://www.youtube.com/watch?v=AQcSFsQyct8">an entire YouTube video just about punctuation in web addresses</a> on one of Google‚Äôs official channels. About 125,000 people have watched the whole video.</p>
<p><img src="/images/type-keys-line.jpeg" alt=""></p>
<h2>Indexing the web, as it is</h2>
<p>While the burgeoning SEO community was debating how best to please Google, amongst our team of people building a content management system, we were having a completely different philosophical debate: should we be trying to appease Google?</p>
<p>You see, the theory of how we felt Google should work, and what the company had often claimed, was that it looked at the web and used signals like the links or the formatting of webpages to indicate the quality and relevance of content. Put simply, your search ranking with Google was supposed to be based on Google indexing the web as it is.</p>
<p>But what if, due to the market pressure of the increasing value of ranking in Google‚Äôs search results, websites were incentivized to change their content to appeal to Google‚Äôs algorithm? Or, more accurately, to appeal to the values of the people who coded Google‚Äôs algorithm?</p>
<p>We found ourselves resistant to what felt like a coercive effect of Google‚Äôs rising domination, especially since Google‚Äôs own Blogger platform was a competitor of ours. Our expression of that frustration was expressed by a debate over a single character: We were using _ because we thought it looked nicer, so why should we change to - just because Google liked it better? Weren‚Äôt they supposed to adapt to what we published on the web?</p>
<h2>Holding the line</h2>
<p>For a while, the team I was working on resisted changing our software to use dashes instead of underscores. My rationale was simple‚Ää‚Äî‚ÄäGoogle has tons of money, why should we change the design of our tools for free, just to make things easier for a big company like Google? The WordPress community made a more pragmatic call, figuring (quite reasonably!) that users wanted to rank well in Google, they made sure their tool‚Äôs default was to use the punctuation that the search engine preferred.</p>
<p>At a literal level, the technical differences here were trivial. But the different choices of punctuation reflected very different philosophies about how the web should work. Dashes vs underscores represented a profound question: <strong>Would we change our apps and our content to suit big companies like Google, or should those big companies accommodate us?</strong></p>
<p><img src="/images/type-punctuation.png" alt=""></p>
<h2>Caving In</h2>
<p>Eventually, most people who were publishing on the web said they didn‚Äôt want to do anything to risk diminishing their Google ranking, and our team had pretty much no choice but to switch to letting people publish web addresses using dashes. I genuinely felt like we had caved in. Caring so much about a single punctuation mark was, of course, an absurd hill to die on, but having Google coerce us into changing our software, and our aesthetics, felt like the first step toward a slippery slope of further concessions.</p>
<p>But the truth was even worse. Despite my misgivings about Google, I didn‚Äôt notice a more nefarious pattern that was established at the same time. A whole <em>community</em> had formed around trying to guess how Google‚Äôs algorithm worked, and that community very quickly built an entire infrastructure around reverse-engineering the algorithms that drive attention and popularity on the web.</p>
<p>Google was teaching us that the way to win on the web is to game the algorithms of big companies.</p>
<p>A few years later, Google <a href="https://www.cnet.com/news/underscores-are-now-word-separators-proclaims-google/">changed their mind</a> and said we could use either dashes or underscores, and people should use whatever they want. But by then it was too late, we‚Äôd all already fallen in line.</p>
<hr>
<h2>Finally, the algorithmic arms race</h2>
<p>In that old era of the social web, the community‚Äôs shared knowledge of how to game algorithms was mostly used for harmless things. People would try to get more readers for their personal blogs, or pull off silly stunts like ‚ÄúGoogle bombing‚Äù, which was essentially just playing with getting a certain site to rank high in Google‚Äôs results for a particular term. It‚Äôs no wonder we thought it was no big deal if we changed our apps to make content that suited Google‚Äôs arbitrary rules. None of this stuff mattered <em>that</em> much, right?</p>
<p>But by attaching monetary value to search ranking, what Google ended up catalyzing was a never-ending arms race, where they constantly updated their algorithm and each community on the web constantly tried to learn how to exploit the new mechanics. The stakes of the algorithmic arms race kept going up; instead of being about pulling off silly pranks, understanding how to appease Google became the cornerstone of multi-million-dollar marketing campaigns. Instead of being about one character in a web address, it became about publishing content that suited the algorithm, whether it was true or not. At first, the only people paying attention were nerds making content management systems, then a broader audience of people trying to optimize their search engine positioning.</p>
<p>Eventually, though, movements across the political spectrum came to understand that knowledge of how to appease the algorithms that govern social media had profound social and cultural power. It wasn‚Äôt just marketers who figured out the best way to promote their ideas, it was trolls and activists and harassers and people on the fringes who wouldn‚Äôt have had any way to get the word out before‚Äîboth for better and for worse. At that point, the rise of <a href="https://medium.com/humane-tech/tech-and-the-fake-market-tactic-8bd386e3d382">fake media markets</a> was inevitable.</p>
<hr>
<p>By the time we realized that we‚Äôd gotten suckered into a neverending two-front battle against both the algorithms of the major tech companies and the destructive movements that wanted to exploit them, it was too late. We‚Äôd already set the precedent that independent publishers and tech creators would just keep chasing whatever algorithm Google (and later Facebook and Twitter) fed to us.</p>
<p>Now, the challenge is to reform these systems so that we can hold the big platforms accountable for the impacts of their algorithms. We‚Äôve got to encourage today‚Äôs newer creative communities in media and tech and culture to not constrain what they‚Äôre doing to conform to the dictates of an opaque, unknowable algorithm. We have to talk about the choices we made in those early days, even at risk of embarrassing ourselves by showing how naive we were about the influence these algorithms would have over culture.</p>
<p>And ultimately, we have to use the chance we‚Äôve got now to underscore the lessons that we learned from the earliest days of the social web, that still resonate on billions of screens today. So much can come from a decision about just one character on the screen.</p>
<p><img src="/images/type-curve-2.jpeg" alt=""></p>

  </main>

  <aside class="post__aside">

    <nav class="post__pagination">

        <a href="/2017/11/20/star_wars_minute/">
          <span>‚Üê</span>
          <span>Star Wars Minute!</span>
        </a>

      

        <a href="/2017/12/16/every_last_jedi/">
          <span>Every Last Jedi</span>
          <span>‚Üí</span>
        </a>

      
      
    </nav>
  </aside>

</article>

  <script>
    const shareData = {
      title: 'Underscores, Optimization &amp; Arms Races',
      url: 'https://anildash.com/2017/11/29/underscores_optimization_arms_races/'
    }

    const btn = document.querySelector('#share-link');

    // Share must be triggered by "user activation"
    btn.addEventListener('click', async () => {
      try {
        await navigator.share(shareData);
      } catch (err) {
      }
    });  
  </script>
  
      </main>
      <footer class="footer" role="contentinfo">
        <div class="footer__content">
          <!-- Add proper aria labeling -->
          <nav aria-label="Footer navigation">
            <ul class="hero__social-links">
                <li>
                  <a href="/search/" >Search</a>
                </li>
                <li>
                  <a href="/posts/" >All Posts</a>
                </li>
                <!-- Theme toggle button -->
                <li class="theme-toggle-container">
                  <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <span class="theme-toggle-light" aria-hidden="true">‚òÄÔ∏è</span>
                    <span class="theme-toggle-dark" aria-hidden="true">üåô</span>
                  </button>
                </li>
                <li>
                  <a href="/feed.xml" target="_blank" rel="noopener noreferrer" aria-label="RSS Feed">
                    <img src="/images/rss.svg" alt="RSS Feed" width="16" height="16" id="rss-icon" />
                  </a>
                </li>
            </ul>
          </nav>
          
          <!-- Add copyright info -->
          <div class="copyright">
            <p>&copy; 1999‚Äì2025 Anil Dash. Virtually no rights reserved. Just ask nicely.</p>
          </div>
        </div>
      </footer>
    </div>
    
    
    
    
    <!-- Add dark mode toggle script -->
    <script>
      // Theme toggle functionality
      document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        
        // Function to set theme
        const setTheme = (theme) => {
          html.setAttribute('data-theme', theme);
          localStorage.setItem('theme', theme);
        };
        
        // Check for saved theme preference or use system preference
        const savedTheme = localStorage.getItem('theme');
        
        if (savedTheme) {
          // Use saved preference if available
          setTheme(savedTheme);
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          // Use system preference if no saved preference
          setTheme('dark');
        } else {
          // Default to light mode
          setTheme('light');
        }
        
        // Toggle theme when button is clicked
        themeToggle.addEventListener('click', () => {
          const currentTheme = html.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          setTheme(newTheme);
        });
        
        // Listen for system preference changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
          if (!localStorage.getItem('theme')) {
            // Only update if user hasn't set a preference
            setTheme(e.matches ? 'dark' : 'light');
          }
        });
      });
      
      
      

      // Handle focus management for keyboard users
      document.addEventListener('DOMContentLoaded', function() {
        const skipLink = document.querySelector('.skip-link');
        if (skipLink) {
          skipLink.addEventListener('focus', function() {
            this.style.transform = 'translateY(0)';
          });
          skipLink.addEventListener('blur', function() {
            this.style.transform = 'translateY(-100%)';
          });
        }
      });

      // search functionality
      document.addEventListener('DOMContentLoaded', function() {
        const expandableSearch = document.getElementById('expandable-search');
        const searchToggle = document.getElementById('search-toggle');
        const searchClose = document.getElementById('search-close');
        const searchInput = document.getElementById('header-search-input');
        
        if (!expandableSearch || !searchToggle || !searchInput) return;
        
        function openSearch() {
          expandableSearch.classList.add('expanded');
          searchToggle.setAttribute('aria-expanded', 'true');
          searchToggle.setAttribute('aria-label', 'Close search');
          // Focus the input after animation completes
          setTimeout(() => searchInput.focus(), 300);
        }
        
        function closeSearch() {
          expandableSearch.classList.remove('expanded');
          searchToggle.setAttribute('aria-expanded', 'false');
          searchToggle.setAttribute('aria-label', 'Open search');
          searchInput.value = '';
        }
        
        // Toggle search on button click
        searchToggle.addEventListener('click', function() {
          if (expandableSearch.classList.contains('expanded')) {
            closeSearch();
          } else {
            openSearch();
          }
        });
        
        // Close search when close button is clicked
        if (searchClose) {
          searchClose.addEventListener('click', closeSearch);
        }
        
        // Close search on Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && expandableSearch.classList.contains('expanded')) {
            closeSearch();
            searchToggle.focus(); // Return focus to toggle button
          }
        });
        
        // Handle search submission
        searchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && this.value.trim()) {
            e.preventDefault();
            // Redirect to search page with query
            const searchQuery = encodeURIComponent(this.value.trim());
            window.location.href = `/search/?q=${searchQuery}`;
          }
        });
        
        // Close search when clicking outside
        document.addEventListener('click', function(e) {
          if (!expandableSearch.contains(e.target) && expandableSearch.classList.contains('expanded')) {
            closeSearch();
          }
        });
        
        // Prevent search container clicks from closing
        searchInput.parentElement.addEventListener('click', function(e) {
          e.stopPropagation();
        });
      });

    </script>
  </body>
</html>